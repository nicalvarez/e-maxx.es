<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Пересечение двух окружностей</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="/data/jquery.js"></script><script type="text/javascript" src="/data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php" >home</a></li><li><a href="../algo/" class=current>algo</a></li><li><a href="../bookz/" >bookz</a></li><li><a href="../forum/" >forum</a></li><li><a href="../about.php" >about</a></li></ul></td><td class=content><h1>Пересечение двух окружностей</h1><p>Page source on the <a href="http://en.wikipedia.org/wiki/HTML">HTML</a> language:</p><textarea style="width:100%;height:500px">&lt;h1&gt;Пересечение двух окружностей&lt;/h1&gt;

&lt;p&gt;Даны две окружности, каждая определена координатами своего центра и радиусом. Требуется найти все их точки пересечения (либо одна, либо две, либо ни одной точки, либо окружности совпадают).&lt;/p&gt;
&lt;h2&gt;Решение&lt;/h2&gt;
&lt;p&gt;Сведём нашу задачу к задаче о &lt;b&gt;&lt;algohref=circle_line_intersection&gt;Пересечении окружности и прямой&lt;/algohref&gt;&lt;/b&gt;.&lt;/p&gt;
&lt;p&gt;Предположим, не теряя общности, что центр первой окружности - в начале координат (если это не так, то перенесём центр в начало координат, а при выводе ответа будем обратно прибавлять координаты центра). Тогда мы имеем систему двух уравнений:&lt;/p&gt;
&lt;formula&gt;x&lt;sup&gt;2&lt;/sup&gt; + y&lt;sup&gt;2&lt;/sup&gt; = r&lt;sub&gt;1&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;
(x - x&lt;sub&gt;2&lt;/sub&gt;)&lt;sup&gt;2&lt;/sup&gt; + (y - y&lt;sub&gt;2&lt;/sub&gt;)&lt;sup&gt;2&lt;/sup&gt; = r&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/formula&gt;
&lt;p&gt;Вычтем из второго уравнения первое, чтобы избавиться от квадратов переменных:&lt;/p&gt;
&lt;formula&gt;x&lt;sup&gt;2&lt;/sup&gt; + y&lt;sup&gt;2&lt;/sup&gt; = r&lt;sub&gt;1&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;
x (-2x&lt;sub&gt;2&lt;/sub&gt;) + y (-2y&lt;sub&gt;2&lt;/sub&gt;) + (x&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; + y&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; + r&lt;sub&gt;1&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; - r&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;) = 0&lt;/formula&gt;
&lt;p&gt;Таким образом, мы свели задачу о пересечении двух окружностей к задаче о пересечении первой окружности и следующей прямой:&lt;/p&gt;
&lt;formula&gt;Ax + By + C = 0,
A = -2x&lt;sub&gt;2&lt;/sub&gt;,
B = -2y&lt;sub&gt;2&lt;/sub&gt;,
C = x&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; + y&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; + r&lt;sub&gt;1&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; - r&lt;sub&gt;2&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;.&lt;/formula&gt;
&lt;p&gt;А решение последней задачи описано в &lt;algohref=circle_line_intersection&gt;соответствующей статье&lt;/algohref&gt;.&lt;/p&gt;
&lt;p&gt;Единственный &lt;b&gt;вырожденный случай&lt;/b&gt;, который надо рассмотреть отдельно - когда центры окружностей совпадают. Действительно, в этом случае вместо уравнения прямой мы получим уравнение вида 0 = С, где C - некоторое число, и этот случай будет обрабатываться некорректно. Поэтому этот случай нужно рассмотреть отдельно: если радиусы окружностей совпадают, то ответ - бесконечность, иначе - точек пересечения нет.&lt;/p&gt;</textarea></td></tr></table></body></html>